说明书摘要

本发明公开了一种基于深度神经网络的问题答案检索方法。包括如下步骤：1)将基于问答社区的问题答案对构建为训练样本；2)对构建得到的训练样本进行基于深度神经网络的特征表达学习，得到问题答案语义空间及特征生成模型，对于新的问题请求无需重新训练模型；3)利用构建的样本训练问题答案语义空间中问题和答案对应向量表达的相似度度量模型，得到问题与答案的匹配质量得分，基于得分对问题的候选答案进行排序；4)使用学习得到的问题答案检索模型搜索问题对应答案。本发明由于使用了问题答案检索数据驱动的深度神经网络，因此得到的检索模型的语义理解能力更强，在问题答案检索任务中所取得性能较传统的浅层模型方法更好。











 

权利要求书

1.一种基于深度神经网络的问题答案检索方法，其特征在于包括如下步骤：

1)将基于问答社区的问题答案对构建为训练样本；

2)对构建得到的训练样本进行基于深度神经网络的特征表达学习，得到问题答案语义空间及特征生成模型，对于新的问题请求无需重新训练模型；

3)利用构建的样本训练问题答案语义空间中问题和答案对应向量表达的相似度度量模型，得到问题与答案的匹配质量得分，基于得分对问题的候选答案进行排序；

4)使用学习得到的问题答案检索模型搜索问题对应答案。

2.根据权利要求1所述的一种基于深度神经网络的问题答案检索方法，其特征在于，所述的步骤1)包括：

	1)基于社区的问题答案对可包含英文、中文两种类型，通过去除标点符号、停用词、语气助词等（中文语料还需要分词）预处理后，形成每个文档形式如 (q, a, O) 三元组的文档集合C，其中q为经过预处理后的问题，a为对应最佳答案，O为对应次优答案列表；

	2)对于文档集合C中每个文档, 对应构造反例文档，其中来自与无关的其他问题对应的答案，从而生成反例文档集合；

3) C和配合用于训练相似度度量模型，假设有文档集合C中文档, 对应中文档，若相似度得分为, 次优答案列表中所有答案与问题的相似度的最高得分为, 得分为, 显然有>。

3.根据权利要求1所述的一种基于深度神经网络的问题答案检索方法，其特征在于，所述的步骤2)包括：

	1)将文档集合C中所有问题答案对组合成一份由段落构成的文档，其中每个段落对应原文档集合中的一个问题或答案且带有编号i，设文档中段落总数为；基于此文档构建字典V，问题或答案（后文称为段落）中每个单词对应V中一个条目；

2)为学习段落的向量特征，需要获得段落中单词的特征表达: 假设字典V中每个单词对应的向量表达构成特征矩阵W中一列，矩阵，其中d为单词对应向量特征维度；文档中所有段落对应的特征矩阵记作D，编号为i的段落对应的特征为D中第i列，, 其中p为段落对应向量特征维度；

3) 对于文档中某一编号为i的段落，设其由单词序列构成，则在N-gram文法语言模型下，特征生成模型的目标是在预测的同时得到段落的向量特征；构建优化问题，最大化以下对数似然函数：

           （1）

其中是模型参数，是正则化项；

4) 通过深度神经网络学习预测，输入层为当前段落I对应的特征，当前上下文中单词对应的特征,即输入，隐层计算在当前上下文中下一个单词出现的未规范化概率,需要注意到实际上存在两个隐层，最后输出层进行softmax规范化：

           （2）

5)模型参数，对深度神经网络进行反向回馈以得到深度神经网络的各层的参数，为简化模型的训练过程还可去掉tanh隐层，则。根据学习得到的深度神经网络的参数，可以提取段落在语义空间中的向量表达。

4.根据权利要求1所述的一种基于深度神经网络的问题答案检索方法，其特征在于，所述的步骤3)包括：

1)设分别为问题、答案对应的向量表达，两者的相似度度量并非通过欧式距离或余弦距离等传统方法直接计算，而是基于神经网络学习得到，相似度度量学习模型表示为函数：

           （3）

其中，为张量，可以将M理解为k个的矩阵，这k个矩阵均包含了相似度信息，结果为k为向量，向量中第i个元素，为标准形式神经网络的参数。

	此模型是在简单的线性神经网络模型上的改进，当时，模型变为标准线性神经网络模型，K、M、L表示了线性变换的参数；

	2)记模型参数，利用步骤1中得到的文档集合C和和假设>，最小化如下目标函数：

 （4）

目标函数中利用了规范化因子，为平衡参数，为限界超参数；使用随机梯度下降法微调参数直到整个神经网络收敛或达到最大迭代次数。

5.根据权利要求1所述的一种基于深度神经网络的问题答案检索方法，其特征在于，所述的步骤4)包括：

1)对查询文档和候选答案文档，将其输入到训练好的深度神经网络中，可对每一个候选答案文档得到一个排序分数，然后按照排序分数将候选答案文档从大到小进行排序，得到问题答案检索结果。



 

说明书

一种基于深度神经网络的问题答案检索方法

技术领域

本发明涉及问题答案检索，尤其涉及一种基于深度神经网络的问题答案检索方法。

背景技术

近些年百度知道、雅虎问答、Quora、知乎等问答社区渐渐流行起来，与传统的问题回答方式不同，在这些基于社区的图像具有丰富语义。一般来说，图像由一个个的像素点组成，计算机并不能直接理解图像所蕴含的语义信息。随着多媒体技术和网络技术的发展，越来越多的图像涌现出来。检索技术可以帮助用户从海量数据中快速查找到自己感兴趣的内容，成为计算机应用技术中越来越重要的领域。传统的检索技术，无论是基于关键词的检索还是基于内容的检索，都不能很好地满足用户希望用文本检索图像或者图像检索文本的需求。在基于关键词的检索系统中，需要事先对图像进行标注。但是目前存在的图像数量巨大，使得标注过程工程量浩繁。并且，由于标注内容不可避免地会受到标注者主观因素的影响，针对同一个图像，不同的标注者可能会标注不同的关键词，因此关键词往往不能客观反映图像所蕴含的全部语义。基于内容的图像检索技术则不需要对图像进行标注，基于比较用户提交的检索样例与被检索图像之间的相似度来实现图像检索，但是传统基于内容的图像检索技术存在两个弱点：一是用户只能检索与查询例子属于同一类型的媒体对象，如只能通过图像检索图像；二是图像的底层特征和高层语义存在语义鸿沟，即底层特征无法直接反映高层语义，因此检索性能受到限制。为了跨越不同模态数据间的语义鸿沟，更好地理解多媒体语义，同时为了满足用户跨媒体查询的需求，寻求一种基于语义的跨媒体排序方法颇有意义。

发明内容

本发明的目的是克服现有技术的不足，提供一种基于深度神经网络的问题答案检索方法。

基于深度神经网络的问题答案检索方法，包括如下步骤：

1)将基于问答社区的问题答案对构建为训练样本；

2)对构建得到的训练样本进行基于深度神经网络的特征表达学习，得到问题答案语义空间及特征生成模型，对于新的问题请求无需重新训练模型；

3)利用构建的样本训练问题答案语义空间中问题和答案对应向量表达的相似度度量模型，得到问题与答案的匹配质量得分，基于得分对问题的候选答案进行排序；

4)使用学习得到的问题答案检索模型搜索问题对应答案。

所述的步骤1)包括：

1)基于社区的问题答案对可包含英文、中文两种类型，通过去除标点符号、停用词、语气助词等（中文语料还需要分词）预处理后，形成每个文档形式如 (q, a, O) 三元组的文档集合C，其中q为经过预处理后的问题，a为对应最佳答案，O为对应次优答案列表；

2)对于文档集合C中每个文档, 对应构造反例文档，其中来自与无关的其他问题对应的答案，从而生成反例文档集合；

3) C和配合用于训练相似度度量模型，假设有文档集合C中文档, 对应中文档，若相似度得分为, 次优答案列表中所有答案与问题的相似度的最高得分为, 得分为, 显然有>；

所述的步骤2)包括：

1)将文档集合C中所有问题答案对组合成一份由段落构成的文档，其中每个段落对应原文档集合中的一个问题或答案且带有编号i，设文档中段落总数为；基于此文档构建字典V，问题或答案（后文称为段落）中每个单词对应V中一个条目；

2)为学习段落的向量特征，需要获得段落中单词的特征表达: 假设字典V中每个单词对应的向量表达构成特征矩阵W中一列，矩阵，其中d为单词对应向量特征维度；文档中所有段落对应的特征矩阵记作D，编号为i的段落对应的特征为D中第i列，, 其中p为段落对应向量特征维度；

3) 对于文档中某一编号为i的段落，设其由单词序列构成，则在N-gram文法语言模型下，特征生成模型的目标是在预测的同时得到段落的向量特征；构建优化问题，最大化以下对数似然函数：

           （1）

其中是模型参数，是正则化项；

4) 通过深度神经网络学习预测，输入层为当前段落I对应的特征，当前上下文中单词对应的特征,即输入，隐层计算在当前上下文中下一个单词出现的未规范化概率,需要注意到实际上存在两个隐层，最后输出层进行softmax规范化：

           （2）

5)模型参数，对深度神经网络进行反向回馈以得到深度神经网络的各层的参数，为简化模型的训练过程还可去掉tanh隐层，则。根据学习得到的深度神经网络的参数，可以提取段落在语义空间中的向量表达。

所述的步骤3)包括：

1)设分别为问题、答案对应的向量表达，两者的相似度度量并非通过欧式距离或余弦距离等传统方法直接计算，而是基于神经网络学习得到，相似度度量学习模型表示为函数：

           （3）

其中，为张量，可以将M理解为k个的矩阵，这k个矩阵均包含了相似度信息，结果为k为向量，向量中第i个元素，为标准形式神经网络的参数。

	此模型是在简单的线性神经网络模型上的改进，当时，模型变为标准线性神经网络，K、M、L表示了线性变换的参数；

	2)记模型参数，利用步骤1中得到的文档集合C和和假设>，最小化如下目标函数：

 （4）

目标函数中利用了规范化因子，为平衡参数，为限界超参数；使用随机梯度下降法微调参数直到整个神经网络收敛或达到最大迭代次数。

所述的步骤4)包括：

1)对查询文档和候选答案文档，将其输入到训练好的深度神经网络中，可对每一个候选答案文档得到一个排序分数，然后按照排序分数将候选答案文档从大到小进行排序，得到问题答案检索结果。

本发明与背景技术相比，具有的有益的效果是：

本发明针对问题回答系统提出了一种新的基于神经网络的检索方法。该方法不仅仅利用神经网络学习问题答案的特征表达，同时基于问题答案的向量表达和神经网络模型学习两者之间的相似度度量方法，根据学习得到的相似度度量方法对与问题的候选答案进行排序和检索，相较传统的基于关键词的检索或基于主题模型的问题检索，本发明提出的方法能学习得到问题答案更好的特征表达和相似度度量方式，从而具有更好的检索性能。

附图说明

图1是基于深度神经网络的问题答案检索方法示意图。

具体实施方式

本发明通过深度神经网络对问题回答语料进行特征学习和语义理解，将所有的问题和答案映射到一个统一的多语义隐空间中，从而实现问题答案检索。

基于深度神经网络的问题答案检索方法，包括如下步骤：

1)将基于问答社区的问题答案对构建为训练样本；

2)对构建得到的训练样本进行基于深度神经网络的特征表达学习，得到问题答案语义空间及特征生成模型，对于新的问题请求无需重新训练模型；

3)利用构建的样本训练问题答案语义空间中问题和答案对应向量表达的相似度度量模型，得到问题与答案的匹配质量得分，基于得分对问题的候选答案进行排序；

4)使用学习得到的问题答案检索模型搜索问题对应答案。

所述的步骤1)包括：

1)基于社区的问题答案对可包含英文、中文两种类型，通过去除标点符号、停用词、语气助词等（中文语料还需要分词）预处理后，形成每个文档形式如 (q, a, O) 三元组的文档集合C，其中q为经过预处理后的问题，a为对应最佳答案，O为对应次优答案列表；

2)对于文档集合C中每个文档, 对应构造反例文档，其中来自与无关的其他问题对应的答案，从而生成反例文档集合；

3) C和配合用于训练相似度度量模型，假设有文档集合C中文档, 对应中文档，若相似度得分为, 次优答案列表中所有答案与问题的相似度的最高得分为, 得分为, 显然有>；

所述的步骤2)包括：

1)将文档集合C中所有问题答案对组合成一份由段落构成的文档，其中每个段落对应原文档集合中的一个问题或答案且带有编号i，设文档中段落总数为；基于此文档构建字典V，问题或答案（后文称为段落）中每个单词对应V中一个条目；

2)为学习段落的向量特征，需要获得段落中单词的特征表达: 假设字典V中每个单词对应的向量表达构成特征矩阵W中一列，矩阵，其中d为单词对应向量特征维度；文档中所有段落对应的特征矩阵记作D，编号为i的段落对应的特征为D中第i列，, 其中p为段落对应向量特征维度；

3) 对于文档中某一编号为i的段落，设其由单词序列构成，则在N-gram文法语言模型下，特征生成模型的目标是在预测的同时得到段落的向量特征；构建优化问题，最大化以下对数似然函数：

           （1）

其中是模型参数，是正则化项；

4) 通过深度神经网络学习预测，输入层为当前段落I对应的特征，当前上下文中单词对应的特征,即输入，隐层计算在当前上下文中下一个单词出现的未规范化概率,需要注意到实际上存在两个隐层，最后输出层进行softmax规范化：

           （2）

5)模型参数，对深度神经网络进行反向回馈以得到深度神经网络的各层的参数，为简化模型的训练过程还可去掉tanh隐层，则。根据学习得到的深度神经网络的参数，可以提取段落在语义空间中的向量表达。

6)输入问题回答语料作为优化问题的训练样本，求解得到语料特征学习深度神经网络的参数。具体求解算法如下：

所述的步骤3)包括：

1)设分别为问题、答案对应的向量表达，两者的相似度度量并非通过欧式距离或余弦距离等传统方法直接计算，而是基于神经网络学习得到，相似度度量学习模型表示为函数：

           （3）

其中，为张量，可以将M理解为k个的矩阵，这k个矩阵均包含了相似度信息，结果为k为向量，向量中第i个元素，为标准形式神经网络的参数。

	此模型是在简单的线性神经网络模型上的改进，当时，模型变为标准线性神经网络，K、M、L表示了线性变换的参数；

	2)记模型参数，利用步骤1中得到的文档集合C和和假设>，最小化如下目标函数：

 （4）

目标函数中利用了规范化因子，为平衡参数，为限界超参数；使用随机梯度下降法微调参数直到整个神经网络收敛或达到最大迭代次数。

所述的步骤4)包括：

1)对查询文档和候选答案文档，将其输入到训练好的深度神经网络中，可对每一个候选答案文档得到一个排序分数，然后按照排序分数将候选答案文档从大到小进行排序，得到问题答案检索结果。

 

实施例

为了验证本发明的效果，从“维基百科-每日一图”的网页上抓取约2900个网页，分为10个大类，每个网页包含了一张图像以及几段相关的描述文本，以此作为数据集进行实验。如果图像和文本都归属于10大类中的一类，则认为图像和文本相关，否则不相关。将数据集划分为训练集和测试集，本发明在训练集上进行训练，然后在测试集上进行独立评价。对于特征提取按照本发明所说步骤进行，其中去除常见词和生僻词后文本空间设定为5000维。为了客观地评价本发明的算法的性能，使用平均准确率（Mean Average Precision，MAP）对本发明进行评价。MAP的结果如表1所示：

表 1

其中MAP@50是前50个返回结果计算得到的MAP值，MAP@all是所有返回结果计算得到的MAP值。

 

说明书附图









 

申请单位：浙江大学计算机学院

课题负责人：吴飞

发明人：吴飞(18857189126)，鲁伟明，卢鑫炎(18989498012)，王东辉，汤斯亮，邵健，庄越挺

联系电话：0571-87951853